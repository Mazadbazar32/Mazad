<!DOCTYPE html>
<html lang="ckb" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mazad Bazar â€” Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b1020">
  <link rel="icon" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <style>
    :root{
      --bg:#0b1020;--card:#0f172a;--muted:#93a3b8;--txt:#e5e7eb;
      --pri:#22c55e;--pri2:#16a34a;--brand:#6a0dad;--border:#1e293b;
      --danger:#ef4444;--warn:#f59e0b;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Arial;
      background:var(--bg); color:var(--txt); line-height:1.6;
    }
    a{color:inherit; text-decoration:none}
    .container{max-width:1100px; margin:auto; padding:16px 20px}

    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(6px);
      background:rgba(11,16,32,.75);
      border-bottom:1px solid var(--border);
    }
    .row{display:flex; gap:14px; align-items:center; justify-content:space-between}
    .brand{display:flex; gap:10px; align-items:center}
    .badge{background:var(--brand); color:#fff; padding:6px 10px; border-radius:8px; font-weight:800}
    .nav{display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:10px 14px; border:1px solid var(--border); border-radius:10px;
      background:#0f172a; color:var(--txt); cursor:pointer; font-weight:600;
      transition:.18s ease;
    }
    .btn:hover{transform:translateY(-1px); box-shadow:0 6px 16px rgba(0,0,0,.25)}
    .btn.pri{border-color:transparent; background:linear-gradient(135deg, var(--pri), var(--pri2))}
    .btn.warn{background:var(--warn); border-color:transparent; color:#111}
    .btn.danger{background:var(--danger); border-color:transparent}
    .btn.sm{padding:6px 10px; font-weight:700}
    input,select,textarea{
      width:100%; background:#0f172a; color:var(--txt);
      border:1px solid var(--border); border-radius:10px; padding:12px 12px;
    }
    textarea{min-height:110px; resize:vertical}
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:16px; padding:16px;
    }
    .grid{display:grid; gap:16px}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:900px){ .grid.cols-3{grid-template-columns:1fr} .row{flex-wrap:wrap} }
    .pill{padding:6px 10px; border-radius:999px; background:#101826; border:1px solid var(--border); font-weight:700}
    .muted{color:var(--muted)}
    .hr{height:1px;background:var(--border);margin:18px 0}
    .hide{display:none !important}
    .right{direction:rtl} .left{direction:ltr}
  </style>
</head>

<body>
<header>
  <div class="container row">
    <div class="brand">
      <div class="badge">MB</div>
      <div>
        <div style="font-size:18px;font-weight:900">Mazad â€“ Bazar</div>
        <div class="muted" style="font-size:12px" data-i="tagline">Ù¾Û†Ø±ØªØ§ÚµÛŒ Ø³Ø§Ø¯Û•ÛŒ Ù…Ø²Ø§ÛŒØ¯Ø©</div>
      </div>
    </div>

    <div class="nav">
      <select id="lang" class="pill">
        <option value="ckb">Ú©ÙˆØ±Ø¯ÛŒ</option>
        <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
        <option value="en">English</option>
      </select>

      <button class="btn sm" id="btn-login"><span data-i="login">Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</span></button>
      <button class="btn sm warn hide" id="btn-logout"><span data-i="logout">Ú†ÙˆÙˆÙ†Û•Ø¯Û•Ø±Û•ÙˆÛ•</span></button>
      <button class="btn sm pri" id="btn-new"><span data-i="addItem">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§</span> âŠ•</button>
    </div>
  </div>
</header>

<main class="container">

  <!-- HERO -->
  <section class="card" id="hero">
    <div class="row" style="align-items:flex-start">
      <div style="max-width:680px">
        <h2 style="margin:0 0 8px" data-i="welcomeTitle">ğŸš€ Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØª Ø¨Û† Â«Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±Â»</h2>
        <p class="muted" data-i="welcomeDesc">
          Ù¾Ú•Û†Ú˜Û•ÛŒÛ•Ú©ÛŒ Ø³Ø§Ø¯Û•ÛŒ Ù…Ø²Ø§ÛŒØ¯Ø©. Ø¯Û•ØªÙˆØ§Ù†ÛŒØª Ú©Ø§ÚµØ§ Ø¨Ù†ÙˆÙˆØ³ÛŒØŒ Ø¨Û• Ø¯ÙˆÚ¯Ù…Û•ÛŒ Ø¨ÛŒØ¯ Ù†Ø±Ø® Ø²ÛŒØ§Ø¯ Ø¨Ú©Û•ÛŒØŒ
          Ùˆ Ø¦Û•Ø¯Ù…ÛŒÙ† Ø¯Û•ØªÙˆØ§Ù†ÛØª Ù¾Û†Ø³ØªÛ•Ú©Ø§Ù† Ù¾Ø´Ú©Ù†ÛŒÙ† Ø¨Ú©Ø§Øª (Ù‚Ø¨ÙˆÙˆÙ„ / Ú•Û•Ø¯).
        </p>
        <div class="hr"></div>
        <div class="pill left" style="display:inline-block">
          <b data-i="feeLabel">Ú©Ø±ÛÛŒ Ù¾Û†Ø³ØªÚ©Ø±Ø¯Ù†:</b> <span id="fee">2000</span> IQD
          â€¢ <b>FastPay / FIB</b> â†’ <span id="wallet">07827513551</span>
        </div>
      </div>
    </div>
  </section>

  <!-- CREATE / EDIT ITEM -->
  <section class="card hide" id="create">
    <h3 style="margin-top:0" data-i="createTitle">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ù¾Û†Ø³Øª</h3>
    <div class="grid">
      <label><span data-i="fTitle">Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†</span>
        <input id="f-title" placeholder="â€¦"/></label>
      <label><span data-i="fPrice">Ù†Ø±Ø®ÛŒ Ø¯Û•Ø³ØªÙ¾ÛÚ© (IQD)</span>
        <input id="f-price" type="number" min="0" value="0"/></label>
      <label><span data-i="fCategory">Ù‡Ø§ÙˆÙ¾Û†Ù„</span>
        <select id="f-cat">
          <option value="general" data-i="catGeneral">Ú¯Ø´ØªÛŒ</option>
          <option value="phones" data-i="catPhones">Ù…Û†Ø¨Ø§ÛŒÙ„</option>
          <option value="cars" data-i="catCars">Ø¦Û†ØªÛ†Ù…Ø¨ÛÙ„</option>
          <option value="digital" data-i="catDigital">Ø¯ÛŒØ¬ÛŒØªØ§Úµ</option>
        </select>
      </label>
      <label style="grid-column:1/-1"><span data-i="fDesc">ÙˆÛ•Ø³Ù/Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ø²Û†Ø±ØªØ±</span>
        <textarea id="f-desc" placeholder="â€¦"></textarea></label>
      <label style="grid-column:1/-1"><span data-i="fImage">ÙˆÛÙ†Û• (URL ÛŒÛ•Ú© ÛŒØ§Ù† Ú†Û•Ù†Ø¯ÛŒÙ† Ø¨Û• Ú©Û†Ù…Ø§)</span>
        <input id="f-images" placeholder="https://â€¦ , https://â€¦"/></label>

      <div class="hr" style="grid-column:1/-1"></div>

      <div style="grid-column:1/-1">
        <b data-i="payTitle">Ù¾Ø§Ø±Û•Ø¯Ø§Ù† Ø¨Û† Ù†Ø§Ø±Ø¯Ù†ÛŒ Ù¾Û†Ø³Øª (2000 IQD):</b><br/>
        <label class="pill"><input type="radio" name="pay" value="FastPay" checked> FastPay</label>
        <label class="pill"><input type="radio" name="pay" value="FIB"> FIB</label>
        <div class="muted" style="margin-top:8px" data-i="payNote">
          ØªÚ©Ø§ÛŒÛ• 2000 IQD Ø¨Û† Ú˜Ù…Ø§Ø±Û•ÛŒ <b id="wallet2">07827513551</b> Ø¨Ù†ÛØ±Û• Ùˆ Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Ø§Ù…Û•ÚµÛ•/Ø±Ø³ÛŒØ¯ Ø¯Ø§Ø®Úµ Ø¨Ú©Û•.
        </div>
      </div>

      <label style="grid-column:1/-1"><span data-i="fTxn">Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Ø§Ù…Û•ÚµÛ•/Ø±Ø³ÛŒØ¯</span>
        <input id="f-txn" placeholder="#TXN12345"/></label>
    </div>
    <div class="row" style="margin-top:14px; justify-content:flex-end">
      <button class="btn" id="btn-cancel" data-i="cancel">Ù‡Û•ÚµÙˆÛ•Ø´Ø§Ù†Ø¯Ù†Û•ÙˆÛ•</button>
      <button class="btn pri" id="btn-save" data-i="submitPost">Ù†Ø§Ø±Ø¯Ù†ÛŒ Ù¾Û†Ø³Øª</button>
    </div>
    <div class="muted" style="margin-top:10px" data-i="createFoot">
      ØªÛØ¨ÛŒÙ†ÛŒ: Ø¦Û•Ø¯Ù…ÛŒÙ† Ù¾Û†Ø³ØªÛ•Ú©Û• Ø¯Û•Ø¨ÛŒÙ†ÛØªØ› Ø¯Û•ØªÙˆØ§Ù†ÛØª Ù‚Ø¨ÙˆÙˆÙ„ ÛŒØ§Ù† Ú•Û•Ø¯ Ø¨Ú©Ø§Øª Ùˆ Ù‡Û†Ú©Ø§Ø± Ø¨Ù†ÙˆÙˆØ³ÛØª.
    </div>
  </section>

  <!-- LISTINGS -->
  <section class="grid cols-3" id="list"></section>

  <!-- ADMIN -->
  <section class="card hide" id="admin">
    <h3 style="margin:0 0 10px" data-i="adminTitle">Ù„ÙˆÙˆØ­Û•ÛŒ Ø¦Û•dmÛŒÙ†</h3>
    <details>
      <summary class="pill" data-i="pendingPosts">Ù¾Û†Ø³ØªÛ• Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†Û•Ú©Ø§Ù†</summary>
      <div id="pending" class="grid" style="margin-top:14px"></div>
    </details>

    <div class="hr"></div>

    <details>
      <summary class="pill" data-i="settings">Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†</summary>
      <div class="grid" style="margin-top:10px">
        <label><span data-i="feeLabel">Ú©Ø±ÛÛŒ Ù¾Û†Ø³ØªÚ©Ø±Ø¯Ù† (IQD)</span>
          <input id="set-fee" type="number" min="0" value="2000"></label>
        <label><span data-i="walletLabel">Ú˜Ù…Ø§Ø±Û•ÛŒ Ù¾Ø§Ø±Û•ÙˆÛ•Ø±Ø§Ù†</span>
          <input id="set-wallet" value="07827513551"></label>
        <button class="btn pri" id="btn-save-settings" data-i="save">Ù¾Ø§Ø´Û•Ú©Û•ÙˆØª</button>
      </div>
    </details>

    <div class="hr"></div>

    <details id="super-block" class="hide">
      <summary class="pill">Super Admin</summary>
      <div class="grid" style="margin-top:10px">
        <label>Admins (comma separated usernames)
          <input id="set-admins" placeholder="admin,ali,dlshad"></label>
        <button class="btn pri" id="btn-save-admins" data-i="save">Ù¾Ø§Ø´Û•Ú©Û•ÙˆØª</button>
      </div>
    </details>
  </section>

</main>

<!-- AUTH MODAL (simple) -->
<div id="auth" class="hide" style="
  position:fixed; inset:0; background:rgba(0,0,0,.6);
  display:flex; align-items:center; justify-content:center;">
  <div class="card" style="width:min(520px,95vw)">
    <h3 style="margin-top:0" data-i="login">Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</h3>
    <div class="grid">
      <label><span data-i="username">Ù†Ø§ÙˆÛŒ Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±</span>
        <input id="u-name" placeholder="Ù…Ø«Ø§Ù„: kurosh"/></label>
      <label><span data-i="password">ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ</span>
        <input id="u-pass" type="password" placeholder="â€¦"/></label>
      <label><span data-i="role">Ú•Û†Úµ</span>
        <select id="u-role">
          <option value="user" data-i="roleUser">Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±</option>
          <option value="admin" data-i="roleAdmin">Ø¦Û•dmÛŒÙ†</option>
          <option value="super" data-i="roleSuper">Ø³ÙˆÙˆÙ¾Û•Ø± Ø¦Û•dmÛŒÙ†</option>
        </select>
      </label>
    </div>
    <div class="row" style="margin-top:12px; justify-content:flex-end">
      <button class="btn" id="a-cancel" data-i="cancel">Ù‡Û•ÚµÙˆÛ•Ø´Ø§Ù†Ø¯Ù†Û•ÙˆÛ•</button>
      <button class="btn pri" id="a-ok" data-i="login">Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</button>
    </div>
    <div class="muted" style="margin-top:8px">
      demo:
      <code>super / super123 (Ø³ÙˆÙˆÙ¾Û•Ø±)</code> â€”
      <code>admin / admin123 (Ø¦Û•dmÛŒÙ†)</code>
    </div>
  </div>
</div>

<script>
/* ===== i18n ===== */
const T = {
  ckb:{
    tagline:"Ù¾Û†Ø±ØªØ§ÚµÛŒ Ø³Ø§Ø¯Û•ÛŒ Ù…Ø²Ø§ÛŒØ¯Ø©",
    welcomeTitle:"ğŸš€ Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØª Ø¨Û† Â«Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±Â»",
    welcomeDesc:"Ù¾Û†Ø³Øª Ø¨Ù†ÙˆÙˆØ³Û•ØŒ Ø¨Û• Ø¯ÙˆÚ¯Ù…Û•ÛŒ Ø¨ÛŒØ¯ Ù†Ø±Ø® Ø²ÛŒØ§Ø¯ Ø¨Ú©Û•ØŒ Ø¦Û•dmÛŒÙ† Ø¯Û•ØªÙˆØ§Ù†ÛØª Ù‚Ø¨ÙˆÙˆÙ„/Ú•Û•Ø¯ Ø¨Ú©Ø§Øª.",
    login:"Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•", logout:"Ú†ÙˆÙˆÙ†Û•Ø¯Û•Ø±Û•ÙˆÛ•", addItem:"Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§",
    createTitle:"Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ù¾Û†Ø³Øª", fTitle:"Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†", fPrice:"Ù†Ø±Ø®ÛŒ Ø¯Û•Ø³ØªÙ¾ÛÚ© (IQD)",
    fCategory:"Ù‡Ø§ÙˆÙ¾Û†Ù„", catGeneral:"Ú¯Ø´ØªÛŒ", catPhones:"Ù…Û†Ø¨Ø§ÛŒÙ„", catCars:"Ø¦Û†ØªÛ†Ù…Ø¨ÛÙ„", catDigital:"Ø¯ÛŒØ¬ÛŒØªØ§Úµ",
    fDesc:"ÙˆÛ•Ø³Ù/Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ", fImage:"ÙˆÛÙ†Û• (URL Ø¨Û• Ú©Û†Ù…Ø§ Ø¬ÛŒØ§ Ø¨Ú©Û•)", payTitle:"Ù¾Ø§Ø±Û•Ø¯Ø§Ù†",
    payNote:"ØªÚ©Ø§ÛŒÛ• 2000 IQD Ø¨Û† Ú˜Ù…Ø§Ø±Û•Ú©Û• Ø¨Ù†ÛØ±Û• Ùˆ Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Ø§Ù…Û•ÚµÛ• Ø¯Ø§Ø®Úµ Ø¨Ú©Û•.",
    fTxn:"Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Ø§Ù…Û•ÚµÛ•", cancel:"Ù‡Û•ÚµÙˆÛ•Ø´Ø§Ù†Ø¯Ù†Û•ÙˆÛ•", submitPost:"Ù†Ø§Ø±Ø¯Ù†ÛŒ Ù¾Û†Ø³Øª",
    createFoot:"Ù¾Ø§Ø´ Ù†Ø§Ø±Ø¯Ù†ØŒ Ù¾Û†Ø³ØªÛ•Ú©Û• Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†ÛŒ Ù‚Ø¨ÙˆÙˆÙ„Ú©Ø±Ø¯Ù†ÛŒ Ø¦Û•dmÛŒÙ† Ø¯Û•Ø¨ÛØª.",
    adminTitle:"Ù„ÙˆÙˆØ­Û•ÛŒ Ø¦Û•dmÛŒÙ†", pendingPosts:"Ù¾Û†Ø³ØªÛ• Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†Û•Ú©Ø§Ù†", settings:"Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†",
    feeLabel:"Ú©Ø±ÛÛŒ Ù¾Û†Ø³ØªÚ©Ø±Ø¯Ù†", walletLabel:"Ú˜Ù…Ø§Ø±Û•ÛŒ Ù¾Ø§Ø±Û•ÙˆÛ•Ø±Ø§Ù†", save:"Ù¾Ø§Ø´Û•Ú©Û•ÙˆØª",
    username:"Ù†Ø§ÙˆÛŒ Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±", password:"ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ", role:"Ú•Û†Úµ",
    roleUser:"Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±", roleAdmin:"Ø¦Û•dmÛŒÙ†", roleSuper:"Ø³ÙˆÙˆÙ¾Û•Ø± Ø¦Û•dmÛŒÙ†",
    bid:"+ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ù†Ø±Ø®", approve:"Ù‚Ø¨ÙˆÙˆÙ„", reject:"Ú•Û•Ø¯Ú©Ø±Ø¯Ù†", reason:"Ù‡Û†Ú©Ø§Ø±",
    by:"Ù„Û•Ù„Ø§ÛŒÛ•Ù†", payMethod:"Ø´ÛÙˆØ§Ø²ÛŒ Ù¾Ø§Ø±Û•Ø¯Ø§Ù†", status:"Ø¯Û†Ø®", pending:"Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†",
    approved:"Ù‚Ø¨ÙˆÙˆÙ„Ú©Ø±Ø§", rejected:"Ú•Û•Ø¯Ú©Ø±Ø§"
  },
  ar:{
    tagline:"Ø¨ÙˆØ§Ø¨Ø© Ù…Ø²Ø§Ø¯ Ø¨Ø³ÙŠØ·Ø©",
    welcomeTitle:"ğŸš€ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Â«Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±Â»",
    welcomeDesc:"Ø£Ø¶Ù Ù…Ù†Ø´ÙˆØ±Ø§Ù‹ØŒ Ø²Ø¯ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø²Ø±Ù‘ Ø§Ù„Ù…Ø²Ø§ÙŠØ¯Ø©ØŒ ÙˆØ§Ù„Ù…Ø¯ÙŠØ± ÙŠÙˆØ§ÙÙ‚ Ø£Ùˆ ÙŠØ±ÙØ¶.",
    login:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", logout:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬", addItem:"Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø¹Ø©",
    createTitle:"Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø´ÙˆØ±", fTitle:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†", fPrice:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ (IQD)",
    fCategory:"Ø§Ù„ÙØ¦Ø©", catGeneral:"Ø¹Ø§Ù…", catPhones:"Ù‡ÙˆØ§ØªÙ", catCars:"Ø³ÙŠØ§Ø±Ø§Øª", catDigital:"Ø±Ù‚Ù…ÙŠ",
    fDesc:"Ø§Ù„ÙˆØµÙ/ØªÙØ§ØµÙŠÙ„", fImage:"ØµÙˆØ±Ø© (Ø±ÙˆØ§Ø¨Ø· Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„)", payTitle:"Ø§Ù„Ø¯ÙØ¹",
    payNote:"Ø§Ø¯ÙØ¹ 2000 Ø¯ÙŠÙ†Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… Ø£Ø¯Ù†Ø§Ù‡ ÙˆØ£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.",
    fTxn:"Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", cancel:"Ø¥Ù„ØºØ§Ø¡", submitPost:"Ø¥Ø±Ø³Ø§Ù„",
    createFoot:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙŠÙ†ØªØ¸Ø± Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±.",
    adminTitle:"Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±", pendingPosts:"Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©", settings:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
    feeLabel:"Ø±Ø³ÙˆÙ… Ø§Ù„Ù†Ø´Ø±", walletLabel:"Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹", save:"Ø­ÙØ¸",
    username:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", password:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±", role:"Ø§Ù„Ø¯ÙˆØ±",
    roleUser:"Ù…Ø³ØªØ®Ø¯Ù…", roleAdmin:"Ù…Ø¯ÙŠØ±", roleSuper:"Ù…Ø¯ÙŠØ± Ø£Ø¹Ù„Ù‰",
    bid:"+ Ù…Ø²Ø§ÙŠØ¯Ø©", approve:"Ù…ÙˆØ§ÙÙ‚Ø©", reject:"Ø±ÙØ¶", reason:"Ø§Ù„Ø³Ø¨Ø¨",
    by:"Ø¨ÙˆØ§Ø³Ø·Ø©", payMethod:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹", status:"Ø§Ù„Ø­Ø§Ù„Ø©",
    pending:"Ù…Ø¹Ù„Ù‘Ù‚", approved:"Ù…Ù‚Ø¨ÙˆÙ„", rejected:"Ù…Ø±ÙÙˆØ¶"
  },
  en:{
    tagline:"Simple auction portal",
    welcomeTitle:"ğŸš€ Welcome to Mazad Bazar",
    welcomeDesc:"Create a post, bid with one click, and admins can approve or reject.",
    login:"Login", logout:"Logout", addItem:"Add Item",
    createTitle:"Create Post", fTitle:"Title", fPrice:"Start Price (IQD)",
    fCategory:"Category", catGeneral:"General", catPhones:"Phones", catCars:"Cars", catDigital:"Digital",
    fDesc:"Description", fImage:"Images (URLs comma separated)", payTitle:"Payment",
    payNote:"Please pay 2000 IQD to the wallet below and enter your transaction id.",
    fTxn:"Transaction ID", cancel:"Cancel", submitPost:"Submit Post",
    createFoot:"After submission, the post waits for admin approval.",
    adminTitle:"Admin Panel", pendingPosts:"Pending posts", settings:"Settings",
    feeLabel:"Post Fee", walletLabel:"Wallet/Number", save:"Save",
    username:"Username", password:"Password", role:"Role",
    roleUser:"User", roleAdmin:"Admin", roleSuper:"Super Admin",
    bid:"+ Bid", approve:"Approve", reject:"Reject", reason:"Reason",
    by:"by", payMethod:"Payment", status:"Status",
    pending:"Pending", approved:"Approved", rejected:"Rejected"
  }
};
const $ = s=>document.querySelector(s);
const $$ = s=>document.querySelectorAll(s);
function tr(){ const L=T[state.lang]; $$('[data-i]').forEach(el=>{const k=el.getAttribute('data-i'); if(L[k]) el.textContent=L[k];}); document.documentElement.lang=state.lang; document.documentElement.dir=(state.lang==='en'?'ltr':'rtl'); }
$('#lang').addEventListener('change',e=>{state.lang=e.target.value; saveState(); tr(); render();});

/* ===== State / Storage ===== */
const LS = {
  load(key,def){ try{ return JSON.parse(localStorage.getItem(key)) ?? def; }catch{ return def; } },
  save(key,val){ localStorage.setItem(key, JSON.stringify(val)); }
};
let state = LS.load('mb_state',{
  lang:'ckb',
  session:null, // {name,role}
});
let db = LS.load('mb_db',{
  settings:{fee:2000,wallet:'07827513551',admins:['admin']},
  items:[] // {id,title,desc,images[],price,owner,method,txn,status,reason,bids:[]}
});
function saveDB(){ LS.save('mb_db',db); }
function saveState(){ LS.save('mb_state',state); }

/* ===== Auth (demo) ===== */
$('#btn-login').onclick = ()=>$('#auth').classList.remove('hide');
$('#a-cancel').onclick = ()=>$('#auth').classList.add('hide');
$('#a-ok').onclick = ()=>{
  const name=$('#u-name').value.trim(); const pass=$('#u-pass').value.trim(); const role=$('#u-role').value;
  // demo passwords
  const ok = (role==='super' && name==='super' && pass==='super123')
          || (role==='admin' && (db.settings.admins.includes(name)) && pass==='admin123')
          || (role==='user'  && name && pass);
  if(!ok){ alert('Login failed'); return; }
  state.session={name,role}; saveState(); $('#auth').classList.add('hide'); render();
};
$('#btn-logout').onclick = ()=>{ state.session=null; saveState(); render(); };

/* ===== Create Post ===== */
$('#btn-new').onclick = ()=>{
  if(!state.session){ $('#auth').classList.remove('hide'); return; }
  $('#create').classList.remove('hide'); window.scrollTo(0,0);
};
$('#btn-cancel').onclick = ()=>$('#create').classList.add('hide');
$('#btn-save').onclick = ()=>{
  const title=$('#f-title').value.trim();
  const price=Number($('#f-price').value||0);
  const desc=$('#f-desc').value.trim();
  const images=($('#f-images').value||'').split(',').map(s=>s.trim()).filter(Boolean);
  const txn=$('#f-txn').value.trim();
  const method=(document.querySelector('input[name=pay]:checked')||{}).value || 'FastPay';
  if(!title || !txn){ alert('Fill title & transaction'); return; }
  const it={ id:Date.now(), title, desc, images, price, owner:state.session?.name||'guest',
             method, txn, status:'pending', reason:'', bids:[] };
  db.items.unshift(it); saveDB();
  $('#create').classList.add('hide');
  alert('Post submitted. Waiting for admin.');
  render();
};

/* ===== Render Listings ===== */
function el(tag,props={}){ const x=document.createElement(tag); Object.assign(x,props); return x; }
function renderList(){
  const wrap = $('#list'); wrap.innerHTML='';
  db.items.filter(it=>it.status==='approved').forEach(it=>{
    const card=el('div',{className:'card'});
    const img = el('img',{src: it.images?.[0]||'https://picsum.photos/600/400?random='+it.id, alt:'', style:'width:100%;border-radius:12px'});
    const t   = el('h3',{textContent:it.title, style:'margin:10px 0 6px'});
    const by  = el('div',{className:'muted', innerHTML:`<b data-i="by">${T[state.lang].by}</b> ${it.owner}`});
    const p   = el('div',{className:'pill left', innerHTML:`IQD <b>${fmt(it.price)}</b>`});
    const row = el('div',{className:'row', style:'margin-top:10px'});
    const b1  = el('button',{className:'btn sm pri', innerText:`${T[state.lang].bid} 1k`});
    const b2  = el('button',{className:'btn sm pri', innerText:`${T[state.lang].bid} 5k`});
    b1.onclick=()=>bid(it,1000); b2.onclick=()=>bid(it,5000);
    row.append(b1,b2);
    card.append(img,t,by,p,row);
    wrap.append(card);
  });
}
function bid(it,inc){
  if(!state.session){ $('#auth').classList.remove('hide'); return; }
  it.price += inc; it.bids.push({by:state.session.name,inc,at:Date.now()}); saveDB(); renderList();
}
function fmt(n){ return (n||0).toLocaleString(); }

/* ===== Admin Panel ===== */
function renderAdmin(){
  const isAdmin = state.session && (state.session.role==='admin' || state.session.role==='super');
  $('#admin').classList.toggle('hide', !isAdmin);
  $('#super-block').classList.toggle('hide', !(state.session && state.session.role==='super'));
  if(!isAdmin) return;

  // settings
  $('#set-fee').value = db.settings.fee;
  $('#set-wallet').value = db.settings.wallet;
  $('#set-admins').value = (db.settings.admins||[]).join(',');

  // pending
  const p = $('#pending'); p.innerHTML='';
  db.items.filter(it=>it.status==='pending').forEach(it=>{
    const card=el('div',{className:'card'});
    card.innerHTML = `
      <div class="row">
        <div><b>${it.title}</b> â€” <span class="muted">${T[state.lang].by}: ${it.owner}</span></div>
        <span class="pill">${T[state.lang].payMethod}: ${it.method} â€¢ TXN: ${it.txn}</span>
      </div>
      <div class="muted" style="margin:6px 0">${it.desc||''}</div>
      <div class="row" style="justify-content:flex-end; gap:8px">
        <input class="pill" id="rea-${it.id}" placeholder="${T[state.lang].reason}" style="min-width:160px">
        <button class="btn sm danger" id="r-${it.id}">${T[state.lang].reject}</button>
        <button class="btn sm pri" id="a-${it.id}">${T[state.lang].approve}</button>
      </div>`;
    p.append(card);
    $(`#a-${it.id}`).onclick = ()=>{ it.status='approved'; it.reason=''; saveDB(); render(); };
    $(`#r-${it.id}`).onclick = ()=>{
      it.status='rejected'; it.reason=$(`#rea-${it.id}`).value||'â€”'; saveDB(); render();
    };
  });

  // save settings
  $('#btn-save-settings').onclick = ()=>{
    db.settings.fee = Number($('#set-fee').value||0);
    db.settings.wallet = $('#set-wallet').value.trim()||db.settings.wallet;
    saveDB(); render();
    alert('Saved.');
  };
  $('#btn-save-admins').onclick = ()=>{
    db.settings.admins = $('#set-admins').value.split(',').map(s=>s.trim()).filter(Boolean);
    saveDB(); alert('Admins updated.');
  };
}

/* ===== Header bits that depend on settings ===== */
function applySettings(){
  $('#fee').textContent = db.settings.fee;
  $('#wallet').textContent = db.settings.wallet;
  $('#wallet2').textContent = db.settings.wallet;
}

/* ===== Render Root ===== */
function render(){
  // session UI
  const logged = !!state.session;
  $('#btn-login').classList.toggle('hide', logged);
  $('#btn-logout').classList.toggle('hide', !logged);

  applySettings();
  tr();
  renderList();
  renderAdmin();
}
render();

/* ===== Register SW (optional if file exists) ===== */
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').catch(()=>{});
}
</script>
</body>
</html>
