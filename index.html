<!DOCTYPE html>
<html lang="ckb" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mazad Bazar â€“ Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±</title>
<style>
:root{
  --bg:#0b1020;--card:#0f172a;--border:#1e293b;
  --txt:#e5e7eb;--muted:#93a3b8;
  --pri:#22c55e;--pri2:#16a34a;--brand:#6a0dad;
}
*{box-sizing:border-box} html,body{margin:0}
body{background:var(--bg);color:var(--txt);font-family:-apple-system,system-ui,Segoe UI,Arial;line-height:1.6}
a{color:inherit;text-decoration:none}
.container{max-width:1100px;margin:auto;padding:16px 20px}
header{position:sticky;top:0;z-index:20;background:rgba(11,16,32,.75);backdrop-filter:blur(6px);border-bottom:1px solid var(--border)}
.nav{display:flex;gap:14px;align-items:center;justify-content:space-between}
.brand{display:flex;gap:10px;align-items:center}
.badge{background:var(--brand);color:#fff;padding:6px 10px;border-radius:8px;font-weight:800}
.langs, .navlinks{display:flex;gap:10px;flex-wrap:wrap}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid #334155;background:#111a2e;color:#e5e7eb;cursor:pointer}
.btn.pri{border-color:transparent;background:linear-gradient(135deg,var(--pri),var(--pri2));color:#0b1220;font-weight:800}
.btn.small{padding:6px 10px;border-radius:10px}
.chip{background:#0f1a2e;border:1px solid var(--border);padding:6px 10px;border-radius:10px;color:var(--muted)}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px}
.grid{display:grid;gap:16px}
.grid-2{grid-template-columns:1fr 1fr}
.grid-3{grid-template-columns:repeat(3,1fr)}
label{font-weight:600;font-size:14px}
input,select,textarea{width:100%;background:#0e1629;color:#e5e7eb;border:1px solid var(--border);border-radius:10px;padding:10px 12px}
textarea{min-height:90px;resize:vertical}
.section{padding:26px 0}
h1,h2,h3,h4{margin:0 0 10px}
.muted{color:var(--muted)}
.list{display:grid;gap:12px}
.item{display:grid;gap:10px;border:1px solid var(--border);border-radius:14px;background:#0d1426;padding:12px}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.price{font-weight:900}
.bad{color:#f87171}.good{color:#4ade80}
footer{border-top:1px solid var(--border);padding:20px 0;color:var(--muted);text-align:center;margin-top:28px}
@media(max-width:900px){.grid-2,.grid-3{grid-template-columns:1fr}}
</style>
</head>
<body>

<header>
  <div class="container nav">
    <div class="brand">
      <span class="badge">MB</span>
      <strong>Mazad â€” Bazar</strong>
    </div>

    <nav class="navlinks">
      <a class="btn small" href="#postForm" data-i="nav_add">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§</a>
      <a class="btn small" href="#market" data-i="nav_market">Ø¨Ø§Ø²Ø§Ø±</a>
      <a class="btn small" href="#admin" data-i="nav_admin">Ù¾Û•Ú•Û•ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†</a>
    </nav>

    <div class="langs">
      <button class="btn small" data-lang="ckb">Ú©ÙˆØ±Ø¯ÛŒ</button>
      <button class="btn small" data-lang="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
      <button class="btn small" data-lang="en">English</button>
    </div>
  </div>
</header>

<main class="container">

  <!-- HERO -->
  <section class="section card">
    <h2 data-i="hero_title">ğŸš€ Ø¨Û•Ø®ÛØ±Ø¨ÛÙ† Ø¨Û† Â«Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±Â»</h2>
    <p class="muted" data-i="hero_desc">
      Ù¾Û†Ø±ØªØ§ÚµÛÚ©ÛŒ Ø³Ø§Ø¯Û•ÛŒ Ù…Ø²Ø§ÛŒØ¯Ø© â€“ Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ Â«Ù Â»Ø› Ú©Ø±ÛØ¯Ø§Ø±Ø§Ù† ØªÛ•Ù†Ù‡Ø§ Ù†Ø±Ø®ÛŒØ§Ù† Ø²ÛŒØ§Ø¯ Ø¯Û•Ú©Û•Ù†.
    </p>
    <div class="row">
      <a class="btn pri" href="#postForm" data-i="cta_add">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§</a>
      <a class="btn" href="#market" data-i="cta_market">Ø¨ÛŒÙ†ÛŒÙ†ÛŒ Ø¨Ø§Ø²Ø§Ø±</a>
    </div>
  </section>

  <!-- POST FORM -->
  <section id="postForm" class="section">
    <h3 data-i="form_title">â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§</h3>
    <div class="card">
      <form id="newPostForm">
        <div class="grid grid-2">
          <div>
            <label data-i="f_name">Ù†Ø§ÙˆÛŒ Ú©Ø§ÚµØ§</label>
            <input required name="name" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù…Û†Ø¨Ø§ÛŒÙ„ S23"/>
          </div>
          <div>
            <label data-i="f_city">Ø´Ø§Ø±/Ø´ÙˆÛÙ†</label>
            <input required name="city" placeholder="Ù‡Û•ÙˆÙ„ÛØ± / Ø³Ù„ÛÙ…Ø§Ù†ÛŒ"/>
          </div>
          <div>
            <label data-i="f_phone">Ú˜Ù…Ø§Ø±Û•ÛŒ ØªÛ•Ù„Û•ÙÙˆÙ†</label>
            <input required name="phone" inputmode="tel" placeholder="07xxxxxxxxx"/>
          </div>
          <div>
            <label data-i="f_img">Ù„ÛŒÙ†Ú©ÛŒ ÙˆÛÙ†Û• (Ø¦ÛØ®ØªÛŒØ§Ø±ÛŒ)</label>
            <input name="image" placeholder="https://â€¦"/>
          </div>
        </div>
        <div style="margin-top:10px">
          <label data-i="f_desc">ÙˆÛ•Ø³Ù</label>
          <textarea name="desc" placeholder="Ú©ÙˆØ±ØªÛ• ÙˆÛ•Ø³ÙÛÚ© Ø¨Ù†ÙˆÙˆØ³Û•â€¦"></textarea>
        </div>

        <div class="grid grid-3" style="margin-top:10px">
          <div>
            <label data-i="f_mode">Ø¬Û†Ø±ÛŒ ÙØ±Û†Ø´ØªÙ†</label>
            <select name="saleMode">
              <option value="auction" selected data-i="mode_auction">Ù…Ø²Ø§ÛŒØ¯Ø©</option>
              <option value="fib" data-i="mode_fib">FIB</option>
              <option value="fastbay" data-i="mode_fastbay">FastBay</option>
            </select>
          </div>
          <div>
            <label data-i="f_base">Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ</label>
            <input name="base" type="number" value="0" min="0" />
            <small class="muted" data-i="f_base_hint">Ø®Ø§ÙˆÛ•Ù†ÛŒ Ù¾Û†Ø³Øª Ù†Ø§ØªÙˆØ§Ù†ÛØª Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ Ø²ÛŒØ§Ø¯ÛŒ Ø¨Ú©Ø§Øªâ€”Â«Ù Â» Ù¾ÛÙˆÛŒØ³ØªÛ•</small>
          </div>
          <div>
            <label data-i="f_step">Ù‚Û•Ø¯Û•Ù†Û•ÛŒ Ø²ÛŒØ§Ø¯Ø¨ÙˆÙˆÙ†</label>
            <input name="step" type="number" value="1000" min="250"/>
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn pri" type="submit" data-i="f_submit">Ù†Ø§Ø±Ø¯Ù† Ø¨Û† Ù¾Ø´Ú©Ù†ÛŒÙ†</button>
          <span class="chip" id="feeInfo"></span>
        </div>
        <p class="muted" style="margin-top:6px" data-i="fee_note">
          Ø¨Û† Ù¾Û†Ø³ØªÛ•Ú©Ø§Ù† Ø¨Û• FIB/FastBay ÙÛŒØ³ÛÚ©ÛŒ Ø®Ø²Ù…Û•ØªÚ¯ÙˆØ²Ø§Ø±ÛŒ (Ù¢Ù Ù Ù  Ø¯ÛŒÙ†Ø§Ø±) Ù‡Û•ÛŒÛ•.
        </p>
      </form>
    </div>
  </section>

  <!-- MARKET -->
  <section id="market" class="section">
    <h3 data-i="market_title">ğŸ›’ Ø¨Ø§Ø²Ø§Ø±</h3>
    <div id="marketList" class="list"></div>
  </section>

  <!-- ADMIN -->
  <section id="admin" class="section">
    <h3 data-i="admin_title">ğŸ” Ù¾Û•Ú•Û•ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†</h3>
    <div class="card">
      <div class="grid grid-3">
        <div>
          <label data-i="login_role">Ú•Û†Úµ</label>
          <select id="roleSelect">
            <option value="viewer" selected data-i="r_viewer">Ø¨ÛŒÙ†Û•Ø±</option>
            <option value="admin" data-i="r_admin">Ø¦Û•Ø¯Ù…ÛŒÙ†</option>
            <option value="super" data-i="r_super">Ø³ÙˆÙ¾Û•Ø±Ø¦Û•Ø¯Ù…ÛŒÙ†</option>
          </select>
        </div>
        <div>
          <label data-i="login_user">Ù†Ø§Ùˆ</label>
          <input id="loginUser" placeholder="username"/>
        </div>
        <div>
          <label data-i="login_pass">ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ</label>
          <input id="loginPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢"/>
        </div>
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn pri" id="btnLogin" data-i="login_btn">Ú†Û†ÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•</button>
        <span class="chip" id="loginState">guest</span>
      </div>
    </div>

    <div class="grid grid-2" style="margin-top:14px">
      <div class="card">
        <h4 data-i="admin_pending">Ù¾Û†Ø³ØªÛ• Ú†Ø§ÙˆÛ•Ø±ÙˆØ§Ù†Û•Ú©Ø§Ù†</h4>
        <div id="pendingList" class="list"></div>
      </div>

      <div class="card">
        <h4 data-i="admin_tools">Ø¦Ø§Ù…Ø±Ø§Ø²Û•Ú©Ø§Ù†</h4>
        <div id="adminTools">
          <p class="muted" data-i="admin_needlogin">Ù¾ÛÙˆÛŒØ³ØªÛ• Ø¨Û• Ø´ÛÙˆÛ•ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†/Ø³ÙˆÙ¾Û•Ø± Ø¨Ú†ÛŒØªÛ• Ú˜ÙˆÙˆØ±Û•ÙˆÛ•.</p>
        </div>
      </div>
    </div>
  </section>

</main>

<footer>
  <div>Â© Mazad Bazar â€” PWA demo. Wallet: <b>07827513551</b></div>
  <div class="muted" id="walletInfo"></div>
</footer>

<script>
/* ========= i18n ========= */
const L = {
  ckb:{
    nav_add:"Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§", nav_market:"Ø¨Ø§Ø²Ø§Ø±", nav_admin:"Ù¾Û•Ú•Û•ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†",
    hero_title:"ğŸš€ Ø¨Û•Ø®ÛØ±Ø¨ÛÙ† Ø¨Û† Â«Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±Â»",
    hero_desc:"Ù¾Û†Ø±ØªØ§ÚµÛÚ©ÛŒ Ø³Ø§Ø¯Û•ÛŒ Ù…Ø²Ø§ÛŒØ¯Ø© â€“ Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ Â«Ù Â»Ø› Ú©Ø±ÛØ¯Ø§Ø±Ø§Ù† ØªÛ•Ù†Ù‡Ø§ Ù†Ø±Ø®ÛŒØ§Ù† Ø²ÛŒØ§Ø¯ Ø¯Û•Ú©Û•Ù†.",
    cta_add:"Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§", cta_market:"Ø¨ÛŒÙ†ÛŒÙ†ÛŒ Ø¨Ø§Ø²Ø§Ø±",

    form_title:"â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§",
    f_name:"Ù†Ø§ÙˆÛŒ Ú©Ø§ÚµØ§", f_city:"Ø´Ø§Ø±/Ø´ÙˆÛÙ†", f_phone:"Ú˜Ù…Ø§Ø±Û•ÛŒ ØªÛ•Ù„Û•ÙÙˆÙ†", f_img:"Ù„ÛŒÙ†Ú©ÛŒ ÙˆÛÙ†Û• (Ø¦ÛØ®ØªÛŒØ§Ø±ÛŒ)",
    f_desc:"ÙˆÛ•Ø³Ù", f_mode:"Ø¬Û†Ø±ÛŒ ÙØ±Û†Ø´ØªÙ†", mode_auction:"Ù…Ø²Ø§ÛŒØ¯Ø©", mode_fib:"FIB", mode_fastbay:"FastBay",
    f_base:"Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ", f_base_hint:"Ø®Ø§ÙˆÛ•Ù†ÛŒ Ù¾Û†Ø³Øª Ù†Ø§ØªÙˆØ§Ù†ÛØª Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ Ø²ÛŒØ§Ø¯ÛŒ Ø¨Ú©Ø§Øªâ€”Â«Ù Â» Ù¾ÛÙˆÛŒØ³ØªÛ•",
    f_step:"Ù‚Û•Ø¯Û•Ù†Û•ÛŒ Ø²ÛŒØ§Ø¯Ø¨ÙˆÙˆÙ†", f_submit:"Ù†Ø§Ø±Ø¯Ù† Ø¨Û† Ù¾Ø´Ú©Ù†ÛŒÙ†", fee_note:"Ø¨Û† Ù¾Û†Ø³ØªÛ•Ú©Ø§Ù† Ø¨Û• FIB/FastBay ÙÛŒØ³ÛÚ©ÛŒ Ø®Ø²Ù…Û•ØªÚ¯ÙˆØ²Ø§Ø±ÛŒ (Ù¢Ù Ù Ù  Ø¯ÛŒÙ†Ø§Ø±) Ù‡Û•ÛŒÛ•.",
    market_title:"ğŸ›’ Ø¨Ø§Ø²Ø§Ø±",

    admin_title:"ğŸ” Ù¾Û•Ú•Û•ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†", login_role:"Ú•Û†Úµ", r_viewer:"Ø¨ÛŒÙ†Û•Ø±", r_admin:"Ø¦Û•Ø¯Ù…ÛŒÙ†", r_super:"Ø³ÙˆÙ¾Û•Ø±Ø¦Û•Ø¯Ù…ÛŒÙ†",
    login_user:"Ù†Ø§Ùˆ", login_pass:"ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ", login_btn:"Ú†Û†ÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•",
    admin_pending:"Ù¾Û†Ø³ØªÛ• Ú†Ø§ÙˆÛ•Ø±ÙˆØ§Ù†Û•Ú©Ø§Ù†", admin_tools:"Ø¦Ø§Ù…Ø±Ø§Ø²Û•Ú©Ø§Ù†", admin_needlogin:"Ù¾ÛÙˆÛŒØ³ØªÛ• Ø¨Û• Ø´ÛÙˆÛ•ÛŒ Ø¦Û•Ø¯Ù…ÛŒÙ†/Ø³ÙˆÙ¾Û•Ø± Ø¨Ú†ÛŒØªÛ• Ú˜ÙˆÙˆØ±Û•ÙˆÛ•.",

    b_approve:"Ù¾Û•Ø³Û•Ù†Ø¯Ú©Ø±Ø¯Ù†", b_reject:"Ú•Û•ØªÚ©Ø±Ø¯Ù†", reason_ph:"Ù‡Û†Ú©Ø§Ø±ÛŒ Ú•Û•ØªÚ©Ø±Ø¯Ù†", status_pending:"Ú†Ø§ÙˆÛ•Ø±ÙˆØ§Ù†", status_ok:"Ù¾Û•Ø³Û•Ù†Ø¯Ú©Ø±Ø§", status_no:"Ú•Û•ØªÚ©Ø±Ø§",
    inc:"Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ù†Ø±Ø®", paymsg:"Ø¨Û•Ø±ÙˆØ§Ø±ÛŒ Ù¾Ø§Ø±Û•Ø¯Ø§Ù† Ø¨Û† ÙÛŒØ³: Ù¢Ù Ù Ù  Ø¯ÛŒÙ†Ø§Ø± â†’ 07827513551"
  },
  ar:{
    nav_add:"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬", nav_market:"Ø§Ù„Ø³ÙˆÙ‚", nav_admin:"Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
    hero_title:"ğŸš€ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø²Ø§Ø¯ Ø¨Ø§Ø²Ø§Ø±", hero_desc:"Ø¨ÙˆØ§Ø¨Ø© Ù…Ø²Ø§ÙŠØ¯Ø§Øª Ø¨Ø³ÙŠØ·Ø© â€“ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ Â«0Â»ØŒ ÙˆØ§Ù„Ø²Ø¨Ø§Ø¦Ù† ÙŠØ±ÙØ¹ÙˆÙ† Ø§Ù„Ø³Ø¹Ø± ÙÙ‚Ø·.",
    cta_add:"Ø£Ø¶Ù Ù…Ù†ØªØ¬Ù‹Ø§", cta_market:"Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙˆÙ‚",

    form_title:"â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬", f_name:"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬", f_city:"Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø§Ù„Ù…ÙˆÙ‚Ø¹", f_phone:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", f_img:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",
    f_desc:"Ø§Ù„ÙˆØµÙ", f_mode:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨ÙŠØ¹", mode_auction:"Ù…Ø²Ø§ÙŠØ¯Ø©", mode_fib:"FIB", mode_fastbay:"FastBay",
    f_base:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ", f_base_hint:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù†Ø§Ø´Ø± Ø±ÙØ¹ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ â€” ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Â«0Â».",
    f_step:"Ø®Ø·ÙˆØ© Ø§Ù„Ø²ÙŠØ§Ø¯Ø©", f_submit:"Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©", fee_note:"Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª FIB/FastBay ØªÙˆØ¬Ø¯ Ø±Ø³ÙˆÙ… Ø®Ø¯Ù…Ø© (2000 Ø¯ÙŠÙ†Ø§Ø±).",
    market_title:"ğŸ›’ Ø§Ù„Ø³ÙˆÙ‚",

    admin_title:"ğŸ” Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©", login_role:"Ø§Ù„Ø¯ÙˆØ±", r_viewer:"Ù…Ø´Ø§Ù‡Ø¯", r_admin:"Ù…Ø¯ÙŠØ±", r_super:"Ù…Ø´Ø±Ù Ø¹Ø§Ù…",
    login_user:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", login_pass:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", login_btn:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    admin_pending:"Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©", admin_tools:"Ø£Ø¯ÙˆØ§Øª", admin_needlogin:"Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ ÙƒÙ…Ø¯ÙŠØ±/Ù…Ø´Ø±Ù.",

    b_approve:"Ù‚Ø¨ÙˆÙ„", b_reject:"Ø±ÙØ¶", reason_ph:"Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶", status_pending:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©", status_ok:"Ù…Ù‚Ø¨ÙˆÙ„", status_no:"Ù…Ø±ÙÙˆØ¶",
    inc:"Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø³Ø¹Ø±", paymsg:"Ø³Ø¯Ø§Ø¯ Ø±Ø³ÙˆÙ… Ø§Ù„Ø®Ø¯Ù…Ø©: 2000 Ø¯ÙŠÙ†Ø§Ø± â†’ 07827513551"
  },
  en:{
    nav_add:"Add Item", nav_market:"Market", nav_admin:"Admin",
    hero_title:"ğŸš€ Welcome to Mazad Bazar", hero_desc:"Simple auction portal â€” base price is â€˜0â€™; buyers only increase.",
    cta_add:"Add Item", cta_market:"View Market",

    form_title:"â• Add Item", f_name:"Item name", f_city:"City/Location", f_phone:"Phone number", f_img:"Image URL (optional)",
    f_desc:"Description", f_mode:"Sale mode", mode_auction:"Auction", mode_fib:"FIB", mode_fastbay:"FastBay",
    f_base:"Base price", f_base_hint:"Owner cannot set a base price > 0 â€” must be â€˜0â€™.",
    f_step:"Bid step", f_submit:"Submit for review", fee_note:"FIB/FastBay posts require a 2,000 IQD service fee.",
    market_title:"ğŸ›’ Market",

    admin_title:"ğŸ” Admin", login_role:"Role", r_viewer:"Viewer", r_admin:"Admin", r_super:"Super Admin",
    login_user:"Username", login_pass:"Password", login_btn:"Sign in",
    admin_pending:"Pending posts", admin_tools:"Tools", admin_needlogin:"Please sign in as admin/super admin.",

    b_approve:"Approve", b_reject:"Reject", reason_ph:"Rejection reason", status_pending:"Pending", status_ok:"Approved", status_no:"Rejected",
    inc:"Increase bid", paymsg:"Service fee due: 2,000 IQD â†’ 07827513551"
  }
};
let lang = localStorage.getItem("mb_lang") || "ckb";
function applyI18n(){
  document.querySelectorAll("[data-i]").forEach(el=>{
    const key=el.dataset.i; el.textContent = L[lang][key] || el.textContent;
  });
  document.getElementById("feeInfo").textContent = L[lang].paymsg;
}
document.querySelectorAll("[data-lang]").forEach(b=>{
  b.onclick=()=>{lang=b.dataset.lang; localStorage.setItem("mb_lang",lang); applyI18n(); renderAll();}
});
applyI18n();

/* ========= Data (localStorage) ========= */
const DB = {
  posts: JSON.parse(localStorage.getItem("mb_posts")||"[]"),
  admins: JSON.parse(localStorage.getItem("mb_admins")||'["admin"]'),
  super: JSON.parse(localStorage.getItem("mb_super")||'["root"]'),
  wallet: JSON.parse(localStorage.getItem("mb_wallet")||'{"07827513551":0}')
};
function save(){ localStorage.setItem("mb_posts", JSON.stringify(DB.posts));
  localStorage.setItem("mb_admins", JSON.stringify(DB.admins));
  localStorage.setItem("mb_super", JSON.stringify(DB.super));
  localStorage.setItem("mb_wallet", JSON.stringify(DB.wallet));
  renderAll();
}

/* ========= Auth (demo) ========= */
let session = {role:"viewer", user:"guest"};
function login(r,u,p){
  if(r==="admin" && DB.admins.includes(u) && p==="admin123"){session={role:"admin",user:u}}
  else if(r==="super" && DB.super.includes(u) && p==="root123"){session={role:"super",user:u}}
  else if(r==="viewer"){session={role:"viewer",user:u||"guest"}}
  else {alert("âš ï¸ Ù‡Û•ÚµÛ• Ù„Û• ØªÛÙ¾Û•Ú•Û•ÙˆØ´Û• ÛŒØ§Ù† Ù†Ø§Ùˆ."); return;}
  document.getElementById("loginState").textContent = `${session.role} â€¢ ${session.user}`;
  renderAdminTools();
}
document.getElementById("btnLogin").onclick=()=>{
  login(document.getElementById("roleSelect").value,
        document.getElementById("loginUser").value.trim(),
        document.getElementById("loginPass").value.trim());
};

/* ========= New Post ========= */
document.getElementById("newPostForm").onsubmit=(e)=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  const item = {
    id: Date.now(),
    name: fd.get("name").trim(),
    city: fd.get("city").trim(),
    phone: fd.get("phone").trim(),
    image: fd.get("image").trim(),
    desc: fd.get("desc").trim(),
    saleMode: fd.get("saleMode"),
    base: 0, // enforce
    step: Math.max(250, parseInt(fd.get("step")||"1000",10)),
    price: 0,
    status: "pending",
    reason: "",
    ownerPaid: false
  };
  // fee rule for FIB/FastBay
  if(item.saleMode!=="auction"){
    item.ownerPaid = true; // demo: mark as paid automatically
    DB.wallet["07827513551"] = (DB.wallet["07827513551"]||0) + 2000;
    alert(L[lang].paymsg + "\n(Ø¯ÛŒÙ…Û†: ÙˆÛ•Ú© Ù¾Ø§Ø±Û•Ø¯Ø±Ø§ Ù‡Û•Ú˜Ù…Ø§Ø± Ú©Ø±Ø§)");
  }
  DB.posts.unshift(item); save();
  e.target.reset();
  alert("âœ… Ù†Ø§Ø±Ø¯Ø±Ø§ Ø¨Û† Ù¾Ø´Ú©Ù†ÛŒÙ†.");
};

/* ========= Market Rendering & Bidding ========= */
function postCard(p, adminView=false){
  const statusMap = {pending:L[lang].status_pending, approved:L[lang].status_ok, rejected:L[lang].status_no};
  const wrap = document.createElement("div"); wrap.className="item";
  const top = document.createElement("div"); top.className="row";
  top.innerHTML = `<strong>${p.name}</strong> <span class="chip">${p.city}</span>
                   <span class="chip">${p.phone}</span>
                   <span class="chip">${p.saleMode.toUpperCase()}</span>
                   <span class="chip ${p.status==="approved"?"good":(p.status==="rejected"?"bad":"")}">
                   ${statusMap[p.status]||p.status}</span>`;
  const img = p.image ? `<img src="${p.image}" alt="" style="max-height:140px;border-radius:10px;border:1px solid var(--border)"/>`:"";
  const desc = `<p class="muted">${p.desc||""}</p>`;
  const price = `<div class="row"><span data-i="inc"></span>:
                 <button class="btn small" data-bid="${p.id}">+${p.step.toLocaleString()}</button>
                 <span class="price">${p.price.toLocaleString()} Ø¯.Ø¹</span></div>`;
  const reason = p.reason? `<div class="muted">ğŸ“ ${p.reason}</div>`:"";
  wrap.innerHTML = top.outerHTML + img + desc + (p.status==="approved"?price:"") + reason;

  // bid button
  wrap.querySelector("[data-bid]")?.addEventListener("click",()=>{
    p.price += p.step; save();
  });

  // admin controls
  if(adminView && (session.role==="admin" || session.role==="super")){
    const tools = document.createElement("div"); tools.className="row"; tools.style.marginTop="6px";
    const reasonInput = document.createElement("input"); reasonInput.placeholder=L[lang].reason_ph; reasonInput.value=p.reason||"";
    reasonInput.style.flex="1";
    const approve = document.createElement("button"); approve.className="btn pri small"; approve.textContent=L[lang].b_approve;
    const reject = document.createElement("button"); reject.className="btn small"; reject.textContent=L[lang].b_reject;
    approve.onclick=()=>{ p.status="approved"; p.reason=""; save(); };
    reject.onclick =()=>{ p.status="rejected"; p.reason=reasonInput.value||L[lang].reason_ph; save(); };
    tools.append(reasonInput, approve, reject);
    wrap.appendChild(tools);
  }
  return wrap;
}

function renderMarket(){
  const list = document.getElementById("marketList");
  list.innerHTML="";
  DB.posts.filter(p=>p.status==="approved").forEach(p=>list.appendChild(postCard(p,false)));
}

function renderPending(){
  const list = document.getElementById("pendingList");
  list.innerHTML="";
  DB.posts.filter(p=>p.status!=="approved").forEach(p=>list.appendChild(postCard(p,true)));
}

/* ========= Admin Tools (super-admin) ========= */
function renderAdminTools(){
  const box = document.getElementById("adminTools");
  box.innerHTML="";
  if(session.role==="viewer"){
    box.innerHTML = `<p class="muted" data-i="admin_needlogin">${L[lang].admin_needlogin}</p>`;
    return;
  }
  const adminsUI = document.createElement("div");
  adminsUI.innerHTML = `<h4>Admins</h4>
    <div class="row">
      <input id="newAdmin" placeholder="username"/>
      <button class="btn small" id="addAdmin">Add</button>
      <button class="btn small" id="delAdmin">Remove</button>
    </div>
    <div class="row" style="margin-top:6px"><span class="chip">List:</span>
      ${DB.admins.map(a=>`<span class="chip">${a}</span>`).join(" ")}
    </div>
    <hr style="border-color:var(--border)">
    <h4>Wallet</h4>
    <div class="row"><span class="chip">07827513551</span>
      <span class="chip">IQD ${ (DB.wallet["07827513551"]||0).toLocaleString() }</span>
      <button class="btn small" id="resetWallet">Reset (demo)</button>
    </div>
  `;
  box.appendChild(adminsUI);

  // only super admin can edit admins/wallet
  if(session.role!=="super"){
    box.querySelectorAll("button,input").forEach(el=>el.disabled=true);
  }else{
    document.getElementById("addAdmin").onclick=()=>{
      const u=document.getElementById("newAdmin").value.trim();
      if(u && !DB.admins.includes(u)){ DB.admins.push(u); save(); }
    };
    document.getElementById("delAdmin").onclick=()=>{
      const u=document.getElementById("newAdmin").value.trim();
      DB.admins = DB.admins.filter(x=>x!==u); save();
    };
    document.getElementById("resetWallet").onclick=()=>{
      DB.wallet["07827513551"]=0; save();
    };
  }
}

/* ========= Wallet footer ========= */
function renderWalletInfo(){
  document.getElementById("walletInfo").textContent =
    "Wallet balance (demo): IQD " + ((DB.wallet["07827513551"]||0).toLocaleString());
}

/* ========= Fees hint per mode ========= */
document.querySelector('select[name="saleMode"]').addEventListener("change", (e)=>{
  const fee = (e.target.value==="auction") ? "" : L[lang].paymsg;
  document.getElementById("feeInfo").textContent = fee;
});

/* ========= Render all ========= */
function renderAll(){ applyI18n(); renderMarket(); renderPending(); renderAdminTools(); renderWalletInfo(); }
renderAll();
</script>
</body>
</html>
